(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-bd402180","chunk-2d22528e"],{"88bc":function(t,e,a){(function(e){var a=1/0,i=9007199254740991,n="[object Arguments]",d="[object Function]",l="[object GeneratorFunction]",r="[object Symbol]",o="object"==typeof e&&e&&e.Object===Object&&e,s="object"==typeof self&&self&&self.Object===Object&&self,u=o||s||Function("return this")();function c(t,e,a){switch(a.length){case 0:return t.call(e);case 1:return t.call(e,a[0]);case 2:return t.call(e,a[0],a[1]);case 3:return t.call(e,a[0],a[1],a[2])}return t.apply(e,a)}function h(t,e){var a=-1,i=t?t.length:0,n=Array(i);while(++a<i)n[a]=e(t[a],a,t);return n}function x(t,e){var a=-1,i=e.length,n=t.length;while(++a<i)t[n+a]=e[a];return t}var I=Object.prototype,f=I.hasOwnProperty,m=I.toString,p=u.Symbol,b=I.propertyIsEnumerable,C=p?p.isConcatSpreadable:void 0,g=Math.max;function y(t,e,a,i,n){var d=-1,l=t.length;a||(a=w),n||(n=[]);while(++d<l){var r=t[d];e>0&&a(r)?e>1?y(r,e-1,a,i,n):x(n,r):i||(n[n.length]=r)}return n}function k(t,e){return t=Object(t),F(t,e,(function(e,a){return a in t}))}function F(t,e,a){var i=-1,n=e.length,d={};while(++i<n){var l=e[i],r=t[l];a(r,l)&&(d[l]=r)}return d}function D(t,e){return e=g(void 0===e?t.length-1:e,0),function(){var a=arguments,i=-1,n=g(a.length-e,0),d=Array(n);while(++i<n)d[i]=a[e+i];i=-1;var l=Array(e+1);while(++i<e)l[i]=a[i];return l[e]=d,c(t,this,l)}}function w(t){return N(t)||O(t)||!!(C&&t&&t[C])}function v(t){if("string"==typeof t||R(t))return t;var e=t+"";return"0"==e&&1/t==-a?"-0":e}function O(t){return S(t)&&f.call(t,"callee")&&(!b.call(t,"callee")||m.call(t)==n)}var N=Array.isArray;function P(t){return null!=t&&j(t.length)&&!B(t)}function S(t){return L(t)&&P(t)}function B(t){var e=$(t)?m.call(t):"";return e==d||e==l}function j(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=i}function $(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function L(t){return!!t&&"object"==typeof t}function R(t){return"symbol"==typeof t||L(t)&&m.call(t)==r}var T=D((function(t,e){return null==t?{}:k(t,h(y(e,1),v))}));t.exports=T}).call(this,a("c8ba"))},e2e0:function(t,e,a){"use strict";function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}a.d(e,"a",(function(){return n})),a.d(e,"b",(function(){return d})),a.d(e,"d",(function(){return l})),a.d(e,"e",(function(){return r})),a.d(e,"c",(function(){return s}));var n={normal:"normal",input:"input",inputNumber:"inputNumber",checkbox:"checkbox",select:"select",date:"date",datetime:"datetime",upload:"upload",file:"file",image:"image",popup:"popup",popupJsh:"popupJsh",list_multi:"list_multi",sel_search:"sel_search",radio:"radio",checkbox_meta:"checkbox_meta",input_pop:"input_pop",slot:"slot",hidden:"hidden"},d=Symbol();function l(t,e){return new Promise((function(a){(function i(){var n=t.$refs[e];n?a(n):setTimeout((function(){i()}),10)})()}))}function r(t,e){if(!t||"function"!==typeof t.validateFields)throw"form 参数需要的是一个form对象，而传入的却是".concat(i(t));var a={};return new Promise((function(e,a){t.validateFields((function(t,i){t?a({error:d}):e(i)}))})).then((function(t){return Object.assign(a,{formValue:t}),o(e)})).then((function(t){return Object.assign(a,{tablesValue:t}),Promise.resolve(a)})).catch((function(t){return Promise.reject(t)}))}function o(t,e){if(!(t instanceof Array))throw"'validateTables'函数的'cases'参数需要的是一个数组，而传入的却是".concat(i(t));return new Promise((function(a,i){var n=[],l=0;t&&0!=t.length||a(),function r(){var o=t[l];o.getAll(!0,e).then((function(e){n[l]=e,++l===t.length?a(n):r()}),(function(t){t===d&&i({error:d,index:l}),i(t)}))}()}))}function s(t,e){var a={};return new Promise((function(e,a){t.validateFields(["number"],(function(t,i){t?a({error:d}):e(i)}))})).then((function(t){return Object.assign(a,{formValue:t}),u(e)})).then((function(t){return Object.assign(a,{tablesValue:t}),Promise.resolve(a)})).catch((function(t){return Promise.reject(t)}))}function u(t,e){if(!(t instanceof Array))throw"'validateTables'函数的'cases'参数需要的是一个数组，而传入的却是".concat(i(t));return new Promise((function(a,i){var n=[],l=0;t&&0!=t.length||a(),function r(){var o=t[l];o.getAll(!1,e).then((function(e){n[l]=e,++l===t.length?a(n):r()}),(function(t){t===d&&i({error:d,index:l}),i(t)}))}()}))}},fbb5:function(t,e,a){"use strict";a.r(e),a.d(e,"BillListMixin",(function(){return m}));var i=a("2b0e"),n=a("0fea"),d=a("e2e0"),l=a("4ec3"),r=a("ca00"),o=a("c1df"),s=a.n(o);a("88bc");function u(t){return I(t)||x(t)||h(t)||c()}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(t,e){if(t){if("string"==typeof t)return f(t,e);var a={}.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?f(t,e):void 0}}function x(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function I(t){if(Array.isArray(t))return f(t)}function f(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=Array(e);a<e;a++)i[a]=t[a];return i}var m={data:function(){return{checkFlag:!0,isShowExcel:!1,purchaseBySaleFlag:!1,waitTotal:0,dateFormat:"YYYY-MM-DD",billExcelUrl:"",defaultDepotId:"",supList:[],cusList:[],retailList:[],userList:[],accountList:[],settingDataIndex:[],expandedRowKeys:[],columns:[],detailColumns:[],defDetailColumns:[],retailOutColumns:[{title:"仓库名称",dataIndex:"depotName"},{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"序列号",dataIndex:"snList",width:300},{title:"批号",dataIndex:"batchNumber"},{title:"有效期",dataIndex:"expirationDate"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"重量",dataIndex:"weight"},{title:"仓位货架",dataIndex:"position"},{title:"备注",dataIndex:"remark"}],retailBackColumns:[{title:"仓库名称",dataIndex:"depotName"},{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"序列号",dataIndex:"snList",width:300},{title:"批号",dataIndex:"batchNumber"},{title:"有效期",dataIndex:"expirationDate"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"重量",dataIndex:"weight"},{title:"仓位货架",dataIndex:"position"},{title:"备注",dataIndex:"remark"}],purchaseApplyColumns:[{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"单位",dataIndex:"unit"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"已采购",dataIndex:"finishNumber"},{title:"备注",dataIndex:"remark"}],purchaseOrderColumns:[{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"已采购",dataIndex:"finishNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"税率(%)",dataIndex:"taxRate"},{title:"税额",dataIndex:"taxMoney"},{title:"价税合计",dataIndex:"taxLastMoney"},{title:"备注",dataIndex:"remark"}],purchaseInColumns:[{title:"仓库名称",dataIndex:"depotName"},{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"序列号",dataIndex:"snList",width:300},{title:"批号",dataIndex:"batchNumber"},{title:"有效期",dataIndex:"expirationDate"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"已入库",dataIndex:"finishNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"税率(%)",dataIndex:"taxRate"},{title:"税额",dataIndex:"taxMoney"},{title:"价税合计",dataIndex:"taxLastMoney"},{title:"重量",dataIndex:"weight"},{title:"仓位货架",dataIndex:"position"},{title:"备注",dataIndex:"remark"}],purchaseBackColumns:[{title:"仓库名称",dataIndex:"depotName"},{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"序列号",dataIndex:"snList",width:300},{title:"批号",dataIndex:"batchNumber"},{title:"有效期",dataIndex:"expirationDate"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"已出库",dataIndex:"finishNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"税率(%)",dataIndex:"taxRate"},{title:"税额",dataIndex:"taxMoney"},{title:"价税合计",dataIndex:"taxLastMoney"},{title:"重量",dataIndex:"weight"},{title:"仓位货架",dataIndex:"position"},{title:"备注",dataIndex:"remark"}],saleOrderColumns:[{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"已销售",dataIndex:"finishNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"税率(%)",dataIndex:"taxRate"},{title:"税额",dataIndex:"taxMoney"},{title:"价税合计",dataIndex:"taxLastMoney"},{title:"备注",dataIndex:"remark"}],saleOutColumns:[{title:"仓库名称",dataIndex:"depotName"},{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"序列号",dataIndex:"snList",width:300},{title:"批号",dataIndex:"batchNumber"},{title:"有效期",dataIndex:"expirationDate"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"已出库",dataIndex:"finishNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"税率(%)",dataIndex:"taxRate"},{title:"税额",dataIndex:"taxMoney"},{title:"价税合计",dataIndex:"taxLastMoney"},{title:"重量",dataIndex:"weight"},{title:"仓位货架",dataIndex:"position"},{title:"备注",dataIndex:"remark"}],saleBackColumns:[{title:"仓库名称",dataIndex:"depotName"},{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"序列号",dataIndex:"snList",width:300},{title:"批号",dataIndex:"batchNumber"},{title:"有效期",dataIndex:"expirationDate"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"已入库",dataIndex:"finishNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"税率(%)",dataIndex:"taxRate"},{title:"税额",dataIndex:"taxMoney"},{title:"价税合计",dataIndex:"taxLastMoney"},{title:"重量",dataIndex:"weight"},{title:"仓位货架",dataIndex:"position"},{title:"备注",dataIndex:"remark"}],otherInColumns:[{title:"仓库名称",dataIndex:"depotName"},{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"序列号",dataIndex:"snList",width:300},{title:"批号",dataIndex:"batchNumber"},{title:"有效期",dataIndex:"expirationDate"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"重量",dataIndex:"weight"},{title:"仓位货架",dataIndex:"position"},{title:"备注",dataIndex:"remark"}],otherOutColumns:[{title:"仓库名称",dataIndex:"depotName"},{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"序列号",dataIndex:"snList",width:300},{title:"批号",dataIndex:"batchNumber"},{title:"有效期",dataIndex:"expirationDate"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"重量",dataIndex:"weight"},{title:"仓位货架",dataIndex:"position"},{title:"备注",dataIndex:"remark"}],allocationOutColumns:[{title:"仓库名称",dataIndex:"depotName"},{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"调入仓库",dataIndex:"anotherDepotName"},{title:"单位",dataIndex:"unit"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"重量",dataIndex:"weight"},{title:"仓位货架",dataIndex:"position"},{title:"备注",dataIndex:"remark"}],assembleColumns:[{title:"商品类型",dataIndex:"mType"},{title:"仓库名称",dataIndex:"depotName"},{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"备注",dataIndex:"remark"}],disassembleColumns:[{title:"商品类型",dataIndex:"mType"},{title:"仓库名称",dataIndex:"depotName"},{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"颜色",dataIndex:"color"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"备注",dataIndex:"remark"}],stockCheckReplayColumns:[{title:"仓库名称",dataIndex:"depotName"},{title:"条码",dataIndex:"barCode"},{title:"名称",dataIndex:"name"},{title:"规格",dataIndex:"standard"},{title:"型号",dataIndex:"model"},{title:"品牌",dataIndex:"brand"},{title:"制造商",dataIndex:"mfrs"},{title:"扩展1",dataIndex:"otherField1"},{title:"扩展2",dataIndex:"otherField2"},{title:"扩展3",dataIndex:"otherField3"},{title:"库存",dataIndex:"stock"},{title:"单位",dataIndex:"unit"},{title:"多属性",dataIndex:"sku"},{title:"数量",dataIndex:"operNumber"},{title:"单价",dataIndex:"unitPrice"},{title:"金额",dataIndex:"allPrice"},{title:"备注",dataIndex:"remark"}],quickBtn:{retailBack:"",purchaseOrder:"",purchaseIn:"",purchaseBack:"",saleOut:"",saleBack:""},queryParam:{beginTime:Object(r["l"])(3),endTime:Object(r["h"])(),createTimeRange:[s()(Object(r["l"])(3)),s()(Object(r["h"])())]}}},computed:{importExcelUrl:function(){return"".concat(window._CONFIG["domianURL"],"/").concat(this.url.importExcelUrl)},isBatchDelEnabled:function(){for(var t=0;t<this.selectedRowKeys.length;t++)if(!this.selectionRows[t].actionsEnabled.delete)return!1;return!0}},created:function(){this.initColumnsSetting(),this.isShowExcel=i["a"].ls.get("isShowExcel")},methods:{loadData:function(t){var e=this;this.expandedRowKeys=[],1===t&&(this.ipagination.current=1);var a=this.getQueryParams();this.loading=!0,Object(n["d"])(this.url.list,a).then((function(t){200===t.code?(e.dataSource=t.data.rows,e.ipagination.total=t.data.total,e.tableAddTotalRow(e.columns,e.dataSource)):510===t.code?e.$message.warning(t.data):e.$message.warning(t.data.message),e.loading=!1,e.onClearSelected()}))},myHandleAdd:function(){this.$refs.modalForm.action="add",-1===this.btnEnableList.indexOf(2)&&(this.$refs.modalForm.isCanCheck=!1),this.handleAdd()},myHandleCopyAdd:function(t){this.$refs.modalForm.action="copyAdd",-1===this.btnEnableList.indexOf(2)&&(this.$refs.modalForm.isCanCheck=!1),t.linkNumber="",t.billType="",t.deposit="",this.$refs.modalForm.edit(t),this.$refs.modalForm.title="复制新增",this.$refs.modalForm.disableSubmit=!1,this.$refs.modalForm.rowCanEdit=!0;var e="组装单"===t.subType||"拆卸单"===t.subType?2:1;this.$refs.modalForm.materialTable.columns[e].type=d["a"].popupJsh},myHandleEdit:function(t){var e=this;"0"===t.status?(this.$refs.modalForm.action="edit",-1===this.btnEnableList.indexOf(2)&&(this.$refs.modalForm.isCanCheck=!1),Object(l["W"])({number:t.number}).then((function(t){if(t&&200===t.code){var a=t.data;e.handleEdit(a)}}))):this.$message.warning("抱歉，只有未审核的单据才能编辑，请先进行反审核！")},myHandleDelete:function(t){"0"===t.status?this.handleDelete(t.id):this.$message.warning("抱歉，只有未审核的单据才能删除，请先进行反审核！")},myHandleDetail:function(t,e,a){-1===this.btnEnableList.indexOf(7)&&(this.$refs.modalDetail.isCanBackCheck=!1),this.handleDetail(t,e,a)},batchForceClose:function(){if(this.url.forceCloseBatch)if(this.selectedRowKeys.length<=0)this.$message.warning("请选择一条记录！");else{for(var t="",e=0;e<this.selectedRowKeys.length;e++)t+=this.selectedRowKeys[e]+",";var a=this;this.$confirm({title:"确认强制结单",content:"是否强制结单选中数据?",onOk:function(){a.loading=!0,Object(n["g"])(a.url.forceCloseBatch,{ids:t}).then((function(t){200===t.code?a.loadData():a.$message.warning(t.data.message)})).finally((function(){a.loading=!1}))}})}else this.$message.error("请设置url.forceCloseBatch属性!")},batchForceClosePurchase:function(){if(this.url.forceClosePurchaseBatch)if(this.selectedRowKeys.length<=0)this.$message.warning("请选择一条记录！");else{for(var t="",e=0;e<this.selectedRowKeys.length;e++)t+=this.selectedRowKeys[e]+",";var a=this;this.$confirm({title:"确认强制结单(以销定购)",content:"是否强制结单选中数据?",onOk:function(){a.loading=!0,Object(n["g"])(a.url.forceClosePurchaseBatch,{ids:t}).then((function(t){200===t.code?a.loadData():a.$message.warning(t.data.message)})).finally((function(){a.loading=!1}))}})}else this.$message.error("请设置url.forceClosePurchaseBatch属性!")},handleApprove:function(t){this.$refs.modalForm.action="approve",this.$refs.modalForm.edit(t),this.$refs.modalForm.title="审核"},searchReset:function(){this.queryParam={type:this.queryParam.type,subType:this.queryParam.subType,beginTime:Object(r["l"])(3),endTime:Object(r["h"])(),createTimeRange:[s()(Object(r["l"])(3)),s()(Object(r["h"])())]},this.loadData(1)},onDateChange:function(t,e){this.queryParam.beginTime=e[0],this.queryParam.endTime=e[1],e[0]&&e[1]&&(this.queryParam.createTimeRange=[s()(e[0]),s()(e[1])])},onDateOk:function(t){},initSystemConfig:function(){var t=this;Object(l["ib"])().then((function(e){if(200===e.code&&e.data){var a=e.data.multiBillType,i=e.data.multiLevelApprovalFlag;t.checkFlag=Object(r["g"])(a,i,t.prefixNo),t.purchaseBySaleFlag="1"===e.data.purchaseBySaleFlag,t.inOutManageFlag="1"===e.data.inOutManageFlag}})),Object(l["tb"])({platformKey:"bill_excel_url"}).then((function(e){e&&200===e.code&&e.data.platformValue&&(t.billExcelUrl=e.data.platformValue)}))},initSupplier:function(){var t=this;Object(l["ab"])({}).then((function(e){e&&(t.supList=e)}))},initCustomer:function(){var t=this;Object(l["X"])({}).then((function(e){e&&(t.cusList=e)}))},initRetail:function(){var t=this;Object(l["Z"])({}).then((function(e){e&&(t.retailList=e)}))},getDepotData:function(){var t=this;Object(n["d"])("/depot/findDepotByCurrentUser").then((function(e){200===e.code?t.depotList=e.data:t.$message.info(e.data)}))},initUser:function(){var t=this;Object(l["wb"])({}).then((function(e){e&&(t.userList=e)}))},initAccount:function(){var t=this;Object(l["eb"])({}).then((function(e){e&&200===e.code&&(t.accountList=e.data.accountList)}))},initWaitBillCount:function(t,e,a){var i=this;Object(l["Eb"])({search:{type:t,subType:e,status:a}}).then((function(t){t&&200===t.code&&(i.waitTotal=t.data.total)}))},initColumnsSetting:function(){var t=this,e=i["a"].ls.get(this.prefixNo);e&&e.indexOf(",")>-1?this.settingDataIndex=e.split(","):this.settingDataIndex=this.defDataIndex,this.columns=this.defColumns.filter((function(e){return t.purchaseBySaleFlag||"CGDD"!==t.prefixNo||"linkNumber"!==e.dataIndex?t.settingDataIndex.includes(e.dataIndex):void 0}))},initQuickBtn:function(){var t=i["a"].ls.get("winBtnStrList");if(t)for(var e=0;e<t.length;e++)t[e].btnStr&&(this.quickBtn.retailBack="/bill/retail_back"===t[e].url?t[e].btnStr:this.quickBtn.retailBack,this.quickBtn.purchaseOrder="/bill/purchase_order"===t[e].url?t[e].btnStr:this.quickBtn.purchaseOrder,this.quickBtn.purchaseIn="/bill/purchase_in"===t[e].url?t[e].btnStr:this.quickBtn.purchaseIn,this.quickBtn.purchaseBack="/bill/purchase_back"===t[e].url?t[e].btnStr:this.quickBtn.purchaseBack,this.quickBtn.saleOut="/bill/sale_out"===t[e].url?t[e].btnStr:this.quickBtn.saleOut,this.quickBtn.saleBack="/bill/sale_back"===t[e].url?t[e].btnStr:this.quickBtn.saleBack)},getDepotByCurrentUser:function(){var t=this;Object(n["d"])("/depot/findDepotByCurrentUser").then((function(e){if(200===e.code)if(1===e.data.length)t.defaultDepotId=e.data[0].id+"";else for(var a=0;a<e.data.length;a++)e.data[a].isDefault&&(t.defaultDepotId=e.data[a].id+"")}))},transferBill:function(t,e){var a=this;if(this.selectedRowKeys.length<=0)this.$message.warning("请选择一条记录！");else if(this.selectedRowKeys.length>1)this.$message.warning("只能选择一条记录！");else{var i=this.selectionRows[0];if("1"===i.status||"3"===i.status){var d="basic";d="转采购订单-以销定购"===t?"purchase":"basic";var l={headerId:i.id,mpList:"",linkType:d};Object(n["d"])("/depotItem/getDetailList",l).then((function(n){if(200===n.code){var d={list:n.data.rows,number:i.number,organId:i.organId,discountMoney:i.discountMoney,deposit:i.deposit,remark:i.remark,accountId:i.accountId,salesMan:i.salesMan};"转采购订单-以销定购"===t?(a.$refs.transferPurchaseModalForm.action="add",a.$refs.transferPurchaseModalForm.transferParam=d,a.$refs.transferPurchaseModalForm.defaultDepotId=a.defaultDepotId,a.$refs.transferPurchaseModalForm.add(),a.$refs.transferPurchaseModalForm.title=t,-1===e.indexOf(2)&&(a.$refs.transferPurchaseModalForm.isCanCheck=!1)):(a.$refs.transferModalForm.action="add",a.$refs.transferModalForm.transferParam=d,a.$refs.transferModalForm.defaultDepotId=a.defaultDepotId,a.$refs.transferModalForm.add(),a.$refs.transferModalForm.title=t,-1===e.indexOf(2)&&(a.$refs.transferModalForm.isCanCheck=!1))}}))}else this.$message.warning("该状态不能"+t+"！")}},onColChange:function(t){this.columns=this.defColumns.filter((function(e){return t.includes(e.dataIndex)}));var e=t.join();i["a"].ls.set(this.prefixNo,e)},handleRestDefault:function(){i["a"].ls.remove(this.prefixNo),this.initColumnsSetting()},handleExport:function(){var t=this.getQueryParams().search;this.$refs.billExcelIframe.show(this.model,this.billExcelUrl+"?search="+t+"&type=1",150),this.$refs.billExcelIframe.title="确认导出"},onExpand:function(t,e){if(t){this.expandedRowKeys=u(new Set([].concat(u(this.expandedRowKeys),[e.id])));var a="basic";"采购"===e.subType||"采购退货"===e.subType||"销售"===e.subType||"销售退货"===e.subType?"3"===e.status&&(a="other"):"3"===e.status?a="basic":"3"===e.purchaseStatus&&(a="purchase");var n={headerId:e.id,mpList:Object(r["i"])(i["a"].ls.get("materialPropertyList")),linkType:a,isReadOnly:"0"},d="/depotItem/getDetailList";this.requestSubTableData(e,d,n)}else this.expandedRowKeys=this.expandedRowKeys.filter((function(t){return t!==e.id}))},requestSubTableData:function(t,e,a,i){var d=this;t.loading=!0,Object(n["d"])(e,a).then((function(e){e&&200===e.code&&(t.childrens=e.data.rows,d.initSetting(t,t.childrens),t.loading=!1,"function"===typeof i&&i(e))})).finally((function(){t.loading=!1}))},initSetting:function(t,e){"LSCK"===this.prefixNo?this.defDetailColumns=this.retailOutColumns:"LSTH"===this.prefixNo?this.defDetailColumns=this.retailBackColumns:"QGD"===this.prefixNo?this.defDetailColumns=this.purchaseApplyColumns:"CGDD"===this.prefixNo?this.defDetailColumns=this.purchaseOrderColumns:"CGRK"===this.prefixNo?this.defDetailColumns=this.purchaseInColumns:"CGTH"===this.prefixNo?this.defDetailColumns=this.purchaseBackColumns:"XSDD"===this.prefixNo?this.defDetailColumns=this.saleOrderColumns:"XSCK"===this.prefixNo?this.defDetailColumns=this.saleOutColumns:"XSTH"===this.prefixNo?this.defDetailColumns=this.saleBackColumns:"QTRK"===this.prefixNo?this.defDetailColumns=this.otherInColumns:"QTCK"===this.prefixNo?this.defDetailColumns=this.otherOutColumns:"DBCK"===this.prefixNo?this.defDetailColumns=this.allocationOutColumns:"ZZD"===this.prefixNo?this.defDetailColumns=this.assembleColumns:"CXD"===this.prefixNo?this.defDetailColumns=this.disassembleColumns:"PDFP"===this.prefixNo&&(this.defDetailColumns=this.stockCheckReplayColumns),this.handleChangeOtherField();for(var a=[],i=0;i<e.length;i++)e[i].snList&&a.push("snList"),e[i].batchNumber&&a.push("batchNumber"),e[i].expirationDate&&a.push("expirationDate"),e[i].sku&&a.push("sku"),e[i].weight&&a.push("weight"),e[i].position&&a.push("position"),e[i].brand&&a.push("brand"),e[i].mfrs&&a.push("mfrs"),e[i].otherField1&&a.push("otherField1"),e[i].otherField2&&a.push("otherField2"),e[i].otherField3&&a.push("otherField3"),e[i].taxRate&&a.push("taxRate"),e[i].remark&&a.push("remark");var n=[];if("3"===t.status){for(var d=0;d<this.defDetailColumns.length;d++)n.push(this.defDetailColumns[d]);this.detailColumns=n}else if("3"===t.purchaseStatus){for(var l=0;l<this.defDetailColumns.length;l++){var r={};r.title=this.defDetailColumns[l].title,r.dataIndex=this.defDetailColumns[l].dataIndex,this.defDetailColumns[l].width&&(r.width=this.defDetailColumns[l].width),"finishNumber"===this.defDetailColumns[l].dataIndex&&(r.title="已采购"),"barCode"===this.defDetailColumns[l].dataIndex&&(r.scopedSlots={customRender:"customBarCode"}),n.push(r)}this.detailColumns=n}else{for(var o=0;o<this.defDetailColumns.length;o++){var s=["finishNumber","snList","batchNumber","expirationDate","sku","weight","position","brand","mfrs","otherField1","otherField2","otherField3","taxRate","remark"];if(-1===s.indexOf(this.defDetailColumns[o].dataIndex)){var u={};u.title=this.defDetailColumns[o].title,u.dataIndex=this.defDetailColumns[o].dataIndex,this.defDetailColumns[o].width&&(u.width=this.defDetailColumns[o].width),"barCode"===this.defDetailColumns[o].dataIndex&&(u.scopedSlots={customRender:"customBarCode"}),n.push(u)}if(a.indexOf(this.defDetailColumns[o].dataIndex)>-1){var c={};c.title=this.defDetailColumns[o].title,c.dataIndex=this.defDetailColumns[o].dataIndex,this.defDetailColumns[o].width&&(c.width=this.defDetailColumns[o].width),n.push(c)}}this.detailColumns=n}},handleChangeOtherField:function(){var t=Object(r["i"])(i["a"].ls.get("materialPropertyList"));if(t){var e=t.split(",");if(3===e.length)for(var a=0;a<this.defDetailColumns.length;a++)"otherField1"===this.defDetailColumns[a].dataIndex&&(this.defDetailColumns[a].title=e[0]),"otherField2"===this.defDetailColumns[a].dataIndex&&(this.defDetailColumns[a].title=e[1]),"otherField3"===this.defDetailColumns[a].dataIndex&&(this.defDetailColumns[a].title=e[2])}}}}}}]);