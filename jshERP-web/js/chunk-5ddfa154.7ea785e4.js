(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5ddfa154","chunk-6c5c513d","chunk-bacaf390","chunk-a82b4092","chunk-5005a329","chunk-2039a09f"],{"2a4c":function(e,t,i){"use strict";i("5f01")},"564f":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{ref:"container"},[t("a-modal",{style:e.modalStyle,attrs:{title:e.title,width:e.width,visible:e.visible,getContainer:function(){return e.$refs.container},maskStyle:{top:"93px",left:"154px"},wrapClassName:e.wrapClassNameInfo(),mask:e.isDesktop(),maskClosable:!1,cancelText:"关闭"},on:{cancel:e.handleCancel}},[t("template",{slot:"footer"},[t("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("取消")])],1),t("a-form",{attrs:{form:e.form}},[[t("iframe",{attrs:{src:e.billPrintUrl,width:"100%",height:e.height,frameborder:"0",scrolling:"no"}})],[t("a-row",[t("a-col",[t("a-form-item",[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id"],expression:"['id']"}],attrs:{hidden:""}})],1)],1)],1)]],2)],2)],1)},r=[],n=i("88bc"),l=i.n(n),o=i("ac0d"),s={name:"BillPrintIframe",mixins:[o["b"]],data:function(){return{title:"三联打印预览",width:"1000px",visible:!1,modalStyle:"",billPrintUrl:"",height:"",model:{},form:this.$form.createForm(this),loading:!1}},created:function(){},methods:{show:function(e,t,i){var a=this;this.height=i,this.billPrintUrl=t,this.visible=!0,this.modalStyle="top:20px;height: 95%;",this.model=Object.assign({},e),this.$nextTick((function(){a.form.setFieldsValue(l()(a.model,"id"))}))},handleCancel:function(){this.close()},close:function(){this.billPrintUrl="",this.$emit("close"),this.visible=!1,this.modalStyle=""}}},d=s,c=i("2877"),u=Object(c["a"])(d,a,r,!1,null,"24219828",null);t["default"]=u.exports},"58b1":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{ref:"container"},[t("a-modal",{staticStyle:{top:"30%",height:"35%"},attrs:{title:e.title,width:500,visible:e.visible,confirmLoading:e.confirmLoading,getContainer:function(){return e.$refs.container},maskStyle:{top:"93px",left:"154px"},wrapClassName:e.wrapClassNameInfo(),mask:e.isDesktop(),maskClosable:!1,cancelText:"关闭"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("template",{slot:"footer"},[e.isReadOnly?t("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("\n        关闭\n      ")]):e._e()],1),t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form,id:"batchSetDepot"}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"仓库名称"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["depotId",e.validatorRules.depotId],expression:"[ 'depotId', validatorRules.depotId ]"}],attrs:{placeholder:"请选择仓库",showSearch:"",optionFilterProp:"children"}},e._l(e.depotList,(function(i,a){return t("a-select-option",{key:a,attrs:{value:i.id}},[e._v("\n              "+e._s(i.depotName)+"\n            ")])})),1)],1)],1)],1)],2)],1)},r=[],n=i("88bc"),l=i.n(n),o=i("0fea"),s=i("ac0d"),d={name:"BatchSetDepot",mixins:[s["b"]],data:function(){return{title:"操作",visible:!1,model:{},depotList:[],isReadOnly:!1,labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{depotId:{rules:[{required:!0,message:"请选择仓库!"}]}}}},created:function(){},methods:{getDepotData:function(){var e=this;Object(o["d"])("/depot/findDepotByCurrentUser").then((function(t){200===t.code?e.depotList=t.data:e.$message.info(t.data)}))},add:function(){this.edit({}),this.getDepotData()},edit:function(e){var t=this;this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue(l()(t.model,"depotId"))}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this,t=this;this.form.validateFields((function(i,a){if(!i){t.confirmLoading=!0;var r=Object.assign(e.model,a),n=r.depotId;t.$emit("ok",n),t.confirmLoading=!1,t.close()}}))},handleCancel:function(){this.close()}}},c=d,u=i("2877"),m=Object(u["a"])(c,a,r,!1,null,"07f97a08",null);t["default"]=m.exports},"5f01":function(e,t,i){},7349:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("j-modal",{style:e.modalStyle,attrs:{title:e.title,width:e.width,visible:e.visible,maskClosable:!1,forceRender:!0,fullscreen:"",switchFullscreen:"",wrapClassName:"ant-modal-cust-warp"},on:{cancel:e.handleCancel}},[t("template",{slot:"footer"},[t("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("取消")])],1),t("a-form",{attrs:{form:e.form}},[[t("iframe",{staticStyle:{width:"100%",border:"none"},attrs:{src:e.billPrintUrl,height:e.height}})],[t("a-row",[t("a-col",[t("a-form-item",[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id"],expression:"['id']"}],attrs:{hidden:""}})],1)],1)],1)]],2)],2)},r=[],n=i("88bc"),l=i.n(n),o=i("ac0d"),s={name:"BillPrintProIframe",mixins:[o["b"]],data:function(){return{title:"三联打印预览",width:"1500px",visible:!1,modalStyle:"",billPrintUrl:"",height:"",model:{},form:this.$form.createForm(this),loading:!1}},created:function(){},methods:{show:function(e,t,i){var a=this;this.height=i,this.billPrintUrl=t,this.visible=!0,this.modalStyle="top:20px;height: 95%;",this.model=Object.assign({},e),this.$nextTick((function(){a.form.setFieldsValue(l()(a.model,"id"))}))},handleCancel:function(){this.close()},close:function(){this.billPrintUrl="",this.$emit("close"),this.visible=!1,this.modalStyle=""}}},d=s,c=i("2877"),u=Object(c["a"])(d,a,r,!1,null,"3ce8d6f0",null);t["default"]=u.exports},"88bc":function(e,t,i){(function(t){var i=1/0,a=9007199254740991,r="[object Arguments]",n="[object Function]",l="[object GeneratorFunction]",o="[object Symbol]",s="object"==typeof t&&t&&t.Object===Object&&t,d="object"==typeof self&&self&&self.Object===Object&&self,c=s||d||Function("return this")();function u(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}function m(e,t){var i=-1,a=e?e.length:0,r=Array(a);while(++i<a)r[i]=t(e[i],i,e);return r}function f(e,t){var i=-1,a=t.length,r=e.length;while(++i<a)e[r+i]=t[i];return e}var p=Object.prototype,h=p.hasOwnProperty,v=p.toString,b=c.Symbol,g=p.propertyIsEnumerable,y=b?b.isConcatSpreadable:void 0,w=Math.max;function k(e,t,i,a,r){var n=-1,l=e.length;i||(i=S),r||(r=[]);while(++n<l){var o=e[n];t>0&&i(o)?t>1?k(o,t-1,i,a,r):f(r,o):a||(r[r.length]=o)}return r}function C(e,t){return e=Object(e),x(e,t,(function(t,i){return i in e}))}function x(e,t,i){var a=-1,r=t.length,n={};while(++a<r){var l=t[a],o=e[l];i(o,l)&&(n[l]=o)}return n}function L(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var i=arguments,a=-1,r=w(i.length-t,0),n=Array(r);while(++a<r)n[a]=i[t+a];a=-1;var l=Array(t+1);while(++a<t)l[a]=i[a];return l[t]=n,u(e,this,l)}}function S(e){return N(e)||O(e)||!!(y&&e&&e[y])}function I(e){if("string"==typeof e||$(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}function O(e){return _(e)&&h.call(e,"callee")&&(!g.call(e,"callee")||v.call(e)==r)}var N=Array.isArray;function j(e){return null!=e&&T(e.length)&&!D(e)}function _(e){return P(e)&&j(e)}function D(e){var t=F(e)?v.call(e):"";return t==n||t==l}function T(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}function F(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function P(e){return!!e&&"object"==typeof e}function $(e){return"symbol"==typeof e||P(e)&&v.call(e)==o}var B=L((function(e,t){return null==e?{}:C(e,m(k(t,1),I))}));e.exports=B}).call(this,i("c8ba"))},c114:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("j-modal",{staticStyle:{top:"20px",height:"95%"},attrs:{title:e.title,width:e.width,visible:e.visible,confirmLoading:e.confirmLoading,keyboard:!1,forceRender:!0,prefixNo:e.prefixNo,fullscreen:"",switchFullscreen:"",id:e.prefixNo},on:{cancel:e.handleCancel}},[t("template",{slot:"footer"},[t("a-button",{on:{click:e.handleCancel}},[e._v("取消")]),e.billPrintFlag&&e.isShowPrintBtn?t("a-button",{on:{click:function(t){return e.handlePrintPro("拆卸单")}}},[e._v("三联打印-新版")]):e._e(),e.billPrintFlag&&e.isShowPrintBtn?t("a-button",{on:{click:function(t){return e.handlePrint("拆卸单")}}},[e._v("三联打印")]):e._e(),e.checkFlag&&e.isCanCheck?t("a-button",{attrs:{loading:e.confirmLoading},on:{click:e.handleOkAndCheck}},[e._v("保存并审核")]):e._e(),t("a-button",{attrs:{type:"primary",loading:e.confirmLoading},on:{click:e.handleOk}},[e._v("保存（Ctrl+S）")]),e.checkFlag?e._e():t("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleWorkflow()}}},[e._v("提交流程")])],1),t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form}},[t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{lg:6,md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"单据日期"}},[t("j-date",{directives:[{name:"decorator",rawName:"v-decorator",value:["operTime",e.validatorRules.operTime],expression:"['operTime', validatorRules.operTime]"}],attrs:{"show-time":!0}})],1)],1),t("a-col",{attrs:{lg:6,md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"单据编号"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["number"],expression:"[ 'number' ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入单据编号"}})],1)],1),t("a-col",{attrs:{lg:6,md:12,sm:24}}),t("a-col",{attrs:{lg:6,md:12,sm:24}})],1),t("j-editable-table",{ref:e.refKeys[0],attrs:{id:"billModal",loading:e.materialTable.loading,columns:e.materialTable.columns,dataSource:e.materialTable.dataSource,minWidth:e.minWidth,maxHeight:300,rowNumber:!0,rowSelection:!0,actionButton:!0},on:{valueChange:e.onValueChange,added:e.onAdded,deleted:e.onDeleted},scopedSlots:e._u([{key:"buttonAfter",fn:function(){return[t("a-row",{staticStyle:{float:"left"},attrs:{gutter:24,"data-step":"4","data-title":"扫码录入","data-intro":"此功能支持扫码枪扫描商品条码进行录入"}},[e.scanStatus?t("a-col",{attrs:{md:6,sm:24}},[t("a-button",{on:{click:e.scanEnter}},[e._v("扫码录入")])],1):e._e(),e.scanStatus?e._e():t("a-col",{staticStyle:{padding:"0 6px 0 12px"},attrs:{md:16,sm:24}},[t("a-input",{ref:"scanBarCode",attrs:{placeholder:"请扫描商品条码并回车"},on:{pressEnter:e.scanPressEnter},model:{value:e.scanBarCode,callback:function(t){e.scanBarCode=t},expression:"scanBarCode"}})],1),e.scanStatus?e._e():t("a-col",{staticStyle:{padding:"0px"},attrs:{md:6,sm:24}},[t("a-button",{on:{click:e.stopScan}},[e._v("收起扫码")])],1)],1)]},proxy:!0},{key:"depotBatchSet",fn:function(){return[t("a-icon",{attrs:{type:"down"},on:{click:e.handleBatchSetDepot}})]},proxy:!0},{key:"depotAdd",fn:function(){return[e.quickBtn.depot?t("a-divider",{staticStyle:{margin:"4px 0"}}):e._e(),e.quickBtn.depot?t("div",{staticClass:"dropdown-btn",on:{click:e.addDepot}},[t("a-icon",{attrs:{type:"plus"}}),e._v(" 新增")],1):e._e(),t("div",{staticClass:"dropdown-btn",on:{mousedown:function(e){return e.preventDefault()},click:e.initDepot}},[t("a-icon",{attrs:{type:"reload"}}),e._v(" 刷新")],1)]},proxy:!0}])}),t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{lg:24,md:24,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:{xs:{span:24},sm:{span:24}},label:""}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["remark"],expression:"[ 'remark' ]"}],staticStyle:{"margin-top":"8px"},attrs:{rows:1,placeholder:"请输入备注"}})],1)],1)],1),t("a-row",{staticClass:"form-row",attrs:{gutter:24}},[t("a-col",{attrs:{lg:6,md:12,sm:24}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"附件"}},[t("j-upload",{attrs:{bizPath:"bill"},model:{value:e.fileList,callback:function(t){e.fileList=t},expression:"fileList"}})],1)],1)],1)],1)],1),t("depot-modal",{ref:"depotModalForm",on:{ok:e.depotModalFormOk}}),t("batch-set-depot",{ref:"batchSetDepotModalForm",on:{ok:e.batchSetDepotModalFormOk}}),t("workflow-iframe",{ref:"modalWorkflow",on:{ok:e.workflowModalFormOk}}),t("bill-print-iframe",{ref:"modalPrint"}),t("bill-print-pro-iframe",{ref:"modalPrintPro"})],2)},r=[],n=i("88bc"),l=i.n(n),o=i("e561"),s=i("58b1"),d=i("9cf1"),c=i("564f"),u=i("7349"),m=i("e2e0"),f=i("d0ed"),p=i("80fd"),h=i("0fea"),v=i("ca00"),b=i("cf74"),g=i("2dab"),y=i("2b0e");function w(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=k(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,l=!0,o=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return l=e.done,e},e:function(e){o=!0,n=e},f:function(){try{l||null==i.return||i.return()}finally{if(o)throw n}}}}function k(e,t){if(e){if("string"==typeof e)return C(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,a=Array(t);i<t;i++)a[i]=e[i];return a}var x={name:"DisassembleModal",mixins:[f["a"],p["BillModalMixin"]],components:{DepotModal:o["default"],BatchSetDepot:s["default"],WorkflowIframe:d["default"],BillPrintIframe:c["default"],BillPrintProIframe:u["default"],JUpload:b["default"],JDate:g["default"]},data:function(){return{title:"操作",width:"1600px",moreStatus:!1,addDefaultRowNum:1,visible:!1,operTimeStr:"",prefixNo:"CXD",fileList:[],model:{},labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}},refKeys:["materialDataTable"],activeKey:"materialDataTable",materialTable:{loading:!1,dataSource:[],columns:[{title:"商品类型",key:"mType",width:"7%",type:m["a"].normal},{title:"仓库名称",key:"depotId",width:"8%",type:m["a"].select,placeholder:"请选择${title}",options:[],allowSearch:!0,validateRules:[{required:!0,message:"${title}不能为空"}]},{title:"条码",key:"barCode",width:"12%",type:m["a"].popupJsh,kind:"material",multi:!0,validateRules:[{required:!0,message:"${title}不能为空"}]},{title:"名称",key:"name",width:"10%",type:m["a"].normal},{title:"规格",key:"standard",width:"9%",type:m["a"].normal},{title:"型号",key:"model",width:"9%",type:m["a"].normal},{title:"颜色",key:"color",width:"5%",type:m["a"].normal},{title:"品牌",key:"brand",width:"6%",type:m["a"].normal},{title:"制造商",key:"mfrs",width:"6%",type:m["a"].normal},{title:"扩展1",key:"otherField1",width:"4%",type:m["a"].normal},{title:"扩展2",key:"otherField2",width:"4%",type:m["a"].normal},{title:"扩展3",key:"otherField3",width:"4%",type:m["a"].normal},{title:"库存",key:"stock",width:"5%",type:m["a"].normal},{title:"单位",key:"unit",width:"4%",type:m["a"].normal},{title:"多属性",key:"sku",width:"4%",type:m["a"].normal},{title:"数量",key:"operNumber",width:"5%",type:m["a"].inputNumber,validateRules:[{required:!0,message:"${title}不能为空"}]},{title:"单价",key:"unitPrice",width:"5%",type:m["a"].inputNumber},{title:"金额",key:"allPrice",width:"5%",type:m["a"].inputNumber},{title:"备注",key:"remark",width:"5%",type:m["a"].input}]},confirmLoading:!1,validatorRules:{operTime:{rules:[{required:!0,message:"请输入单据日期!"}]},type:{rules:[{required:!0,message:"请选择类型!"}]}},url:{add:"/depotHead/addDepotHeadAndDetail",edit:"/depotHead/updateDepotHeadAndDetail",detailList:"/depotItem/getDetailList"}}},created:function(){},methods:{editAfter:function(){var e=this;if(this.billStatus="0",this.currentSelectDepotId="",this.changeColumnHide(),"add"===this.action)this.addInit(this.prefixNo),this.fileList=[];else{this.model.operTime=this.model.operTimeStr,this.fileList=this.model.fileName,this.$nextTick((function(){e.form.setFieldsValue(l()(e.model,"organId","operTime","number","remark","discount","discountMoney","discountLastMoney","otherMoney","accountId","changeAmount"))}));var t={headerId:this.model.id,mpList:Object(v["i"])(y["a"].ls.get("materialPropertyList")),linkType:"basic"},i=(this.readOnly,this.url.detailList);this.requestSubTableData(i,t,this.materialTable)}"copyAdd"===this.action&&(this.model.id="",this.model.tenantId="",this.copyAddInit(this.prefixNo)),this.initSystemConfig(),this.initDepot(),this.initPlatform(),this.initQuickBtn(),this.handleChangeOtherField()},classifyIntoFormData:function(e){var t=0,i=Object.assign(this.model,e.formValue),a=e.tablesValue[0].values;i.type="其它",i.subType="拆卸单";var r,n=w(a);try{for(n.s();!(r=n.n()).done;){var l=r.value;t+=l.allPrice-0}}catch(o){n.e(o)}finally{n.f()}return i.totalPrice=t,this.fileList&&this.fileList.length>0?i.fileName=this.fileList:i.fileName="",this.model.id&&(i.id=this.model.id),i.status=this.billStatus,{info:JSON.stringify(i),rows:JSON.stringify(a)}},onAdded:function(e){var t=e.row,i=e.target;Object(h["d"])("/depot/findDepotByCurrentUser").then((function(e){if(200===e.code)for(var a=e.data,r=0;r<a.length;r++)a[r].isDefault&&i.setValues([{rowKey:t.id,values:{depotId:a[r].id+""}}])})),i.rows.length>=2?i.setValues([{rowKey:t.id,values:{mType:"普通子件"}}]):i.setValues([{rowKey:t.id,values:{mType:"组合件"}}])}}},L=x,S=i("2877"),I=Object(S["a"])(L,a,r,!1,null,"bc080634",null);t["default"]=I.exports},cf74:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{position:"relative"},attrs:{id:e.containerId}},[t("div",{staticClass:"movety-container",staticStyle:{padding:"0 8px",position:"absolute","z-index":"91",height:"32px",width:"104px","text-align":"center"},style:{top:e.top+"px",left:e.left+"px",display:e.moveDisplay}},[t("div",{class:e.showMoverTask?"uploadty-mover-mask":"movety-opt",staticStyle:{"margin-top":"12px"},attrs:{id:e.containerId+"-mover"}},[t("a",{staticStyle:{margin:"0 5px"},on:{click:e.moveLast}},[t("a-icon",{staticStyle:{color:"#fff","font-size":"16px"},attrs:{type:"arrow-left"}})],1),t("a",{staticStyle:{margin:"0 5px"},on:{click:e.moveNext}},[t("a-icon",{staticStyle:{color:"#fff","font-size":"16px"},attrs:{type:"arrow-right"}})],1)])]),t("a-upload",{class:{"uploadty-disabled":e.disabled},attrs:{name:"file",multiple:!0,action:e.uploadAction,headers:e.headers,data:{biz:e.bizPath},fileList:e.fileList,beforeUpload:e.beforeUpload,disabled:e.disabled,returnUrl:e.returnUrl,listType:e.complistType},on:{change:e.handleChange,preview:e.handlePreview}},[[e.isImageComp?t("div",[t("a-icon",{attrs:{type:"plus"}}),t("div",{staticClass:"ant-upload-text"},[e._v(e._s(e.text))])],1):e.buttonVisible?t("a-button",[t("a-icon",{attrs:{type:"upload"}}),e._v(e._s(e.text)+"\n      ")],1):e._e()]],2),t("a-modal",{attrs:{visible:e.previewVisible,width:1e3,footer:null},on:{cancel:e.handleCancel}},[t("img",{staticStyle:{width:"100%"},attrs:{alt:"example",src:e.previewImage}})])],1)},r=[],n=i("2b0e"),l=i("9fb0"),o=i("0fea"),s=i("4ec3"),d="all",c="image",u=function(){return"-"+parseInt(1e4*Math.random()+1,10)},m=function(e){if(e.lastIndexOf("\\")>=0){var t=new RegExp("\\\\","g");e=e.replace(t,"/")}return e.substring(e.lastIndexOf("/")+1)},f={name:"JUpload",data:function(){return{uploadAction:window._CONFIG["domianURL"]+"/systemConfig/upload",headers:{},fileList:[],newFileList:[],uploadGoOn:!0,previewVisible:!1,previewImage:"",containerId:"",top:"",left:"",moveDisplay:"none",showMoverTask:!1,moverHold:!1,currentImg:"",sizeLimit:0}},props:{text:{type:String,required:!1,default:"点击上传"},fileType:{type:String,required:!1,default:d},bizPath:{type:String,required:!1,default:"temp"},value:{type:[String,Array],required:!1},disabled:{type:Boolean,required:!1,default:!1},triggerChange:{type:Boolean,required:!1,default:!1},returnUrl:{type:Boolean,required:!1,default:!0},number:{type:Number,required:!1,default:0},buttonVisible:{type:Boolean,required:!1,default:!0}},watch:{value:{immediate:!0,handler:function(){var e=this.value;e instanceof Array?this.returnUrl?this.initFileList(e.join(",")):this.initFileListArr(e):this.initFileList(e)}}},computed:{isImageComp:function(){return this.fileType===c},complistType:function(){return this.fileType===c?"picture-card":"text"}},created:function(){this.initFileSizeLimit();var e=n["a"].ls.get(l["a"]);this.headers={"X-Access-Token":e},this.containerId="container-ty-"+(new Date).getTime()},methods:{initFileSizeLimit:function(){var e=this;Object(s["V"])().then((function(t){200===t.code&&(e.sizeLimit=t.data)}))},initFileListArr:function(e){if(e&&0!=e.length){for(var t=[],i=0;i<e.length;i++){var a=Object(o["e"])(e[i].filePath);t.push({uid:u(),name:e[i].fileName,status:"done",url:a,response:{code:"history",data:e[i].filePath}})}this.fileList=t}else this.fileList=[]},initFileList:function(e){if(e&&0!=e.length){for(var t=[],i=e.split(","),a=0;a<i.length;a++){var r=Object(o["e"])("systemConfig/static/"+i[a]);t.push({uid:u(),name:m(i[a]),status:"done",url:r,response:{code:"history",data:i[a]}})}this.fileList=t}else this.fileList=[]},handlePathChange:function(){var e=this.fileList,t="";e&&0!=e.length||(t="");for(var i=[],a=0;a<e.length;a++)i.push(e[a].response.data);i.length>0&&(t=i.join(",")),this.$emit("change",t)},beforeUpload:function(e){this.uploadGoOn=!0;var t=e.type,i=e.size;if(this.fileType===c&&t.indexOf("image")<0)return this.$message.warning("请上传图片"),this.uploadGoOn=!1,!1;if(i>this.sizeLimit){var a=(this.sizeLimit/1024/1024).toFixed(2);return this.$message.warning("抱歉，文件大小不能超过"+a+"M"),this.uploadGoOn=!1,!1}return!0},handleChange:function(e){e.file.status||!1!==this.uploadGoOn||e.fileList.pop();var t=e.fileList;if("done"===e.file.status?(this.number>0&&(t=t.slice(-this.number)),200===e.file.response.code&&(t=t.map((function(e){if(e.response){var t=e.response.data;e.url=Object(o["e"])(t)}return e})))):"error"===e.file.status?this.$message.error("".concat(e.file.name," 上传失败.")):"removed"===e.file.status&&this.handleDelete(e.file),this.fileList=t,"done"===e.file.status||"removed"===e.file.status)if(this.returnUrl)this.handlePathChange();else{this.newFileList=[];for(var i=0;i<t.length;i++){var a={fileName:t[i].name,filePath:t[i].response.data,fileSize:t[i].size};this.newFileList.push(a)}this.$emit("change",this.newFileList)}},handleDelete:function(e){},handlePreview:function(e){var t=e.name.substring(e.name.lastIndexOf("."));".gif"===t||".jpg"===t||".jpeg"===t||".png"===t||".GIF"===t||".JPG"===t||".JPEG"===t||".PNG"===t?(this.previewImage=e.url||e.thumbUrl,this.previewVisible=!0):location.href=e.url},handleCancel:function(){this.previewVisible=!1},moveLast:function(){var e=this.getIndexByUrl();if(0==e)this.$message.warn("未知的操作");else{for(var t=this.fileList[e].url,i=this.fileList[e-1].url,a=[],r=0;r<this.fileList.length;r++)r==e-1?a.push(t):r==e?a.push(i):a.push(this.fileList[r].url);this.currentImg=i,this.$emit("change",a.join(","))}},moveNext:function(){var e=this.getIndexByUrl();if(e==this.fileList.length-1)this.$message.warn("已到最后~");else{for(var t=this.fileList[e].url,i=this.fileList[e+1].url,a=[],r=0;r<this.fileList.length;r++)r==e+1?a.push(t):r==e?a.push(i):a.push(this.fileList[r].url);this.currentImg=i,this.$emit("change",a.join(","))}},getIndexByUrl:function(){for(var e=0;e<this.fileList.length;e++)if(this.fileList[e].url===this.currentImg||encodeURI(this.fileList[e].url)===this.currentImg)return e;return-1}},mounted:function(){var e=this,t=document.getElementById(this.containerId+"-mover");t.addEventListener("mouseover",(function(){e.moverHold=!0,e.moveDisplay="block"})),t.addEventListener("mouseout",(function(){e.moverHold=!1,e.moveDisplay="none"}));var i=document.getElementById(this.containerId)?document.getElementById(this.containerId).getElementsByClassName("ant-upload-list-picture-card"):[];i&&i.length>0&&(i[0].addEventListener("mouseover",(function(t){t=t||window.event;var i=t.target||t.srcElement;if("ant-upload-list-item-info"==i.className){e.showMoverTask=!1;var a=i.parentElement;e.left=a.offsetLeft,e.top=a.offsetTop+a.offsetHeight-50,e.moveDisplay="block",e.currentImg=i.getElementsByTagName("img")[0].src}})),i[0].addEventListener("mouseout",(function(t){t=t||window.event;var i=t.target||t.srcElement;"ant-upload-list-item-info"==i.className&&(e.showMoverTask=!0,setTimeout((function(){!1===e.moverHold&&(e.moveDisplay="none")}),100)),"ant-upload-list-item ant-upload-list-item-done"!=i.className&&"ant-upload-list ant-upload-list-picture-card"!=i.className||(e.moveDisplay="none")})))},model:{prop:"value",event:"change"}},p=f,h=(i("2a4c"),i("2877")),v=Object(h["a"])(p,a,r,!1,null,null,null);t["default"]=v.exports},e561:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{ref:"container"},[t("a-modal",{staticStyle:{top:"10%",height:"70%"},attrs:{title:e.title,width:800,visible:e.visible,confirmLoading:e.confirmLoading,getContainer:function(){return e.$refs.container},maskStyle:{top:"93px",left:"154px"},wrapClassName:e.wrapClassNameInfo(),mask:e.isDesktop(),maskClosable:!1,cancelText:"取消",okText:"保存"},on:{ok:e.handleOk,cancel:e.handleCancel}},[t("template",{slot:"footer"},[e.isReadOnly?t("a-button",{key:"back",on:{click:e.handleCancel}},[e._v("\n        取消\n      ")]):e._e()],1),t("a-spin",{attrs:{spinning:e.confirmLoading}},[t("a-form",{attrs:{form:e.form,id:"depotModal"}},[t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"仓库名称"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["name",e.validatorRules.name],expression:"[ 'name', validatorRules.name]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入仓库名称"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"仓库地址"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["address"],expression:"[ 'address' ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入仓库地址"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"仓储费"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["warehousing"],expression:"[ 'warehousing' ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入仓储费",suffix:"元/天/KG"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"搬运费"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["truckage"],expression:"[ 'truckage' ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入搬运费",suffix:"元"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"负责人"}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["principal"],expression:"[ 'principal' ]"}],attrs:{placeholder:"选择负责人",dropdownMatchSelectWidth:!1}},e._l(e.userList,(function(i,a){return t("a-select-option",{key:a,attrs:{value:i.id}},[e._v("\n              "+e._s(i.userName)+"\n            ")])})),1)],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"排序"}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["sort"],expression:"[ 'sort' ]",modifiers:{trim:!0}}],attrs:{placeholder:"请输入排序"}})],1),t("a-form-item",{attrs:{labelCol:e.labelCol,wrapperCol:e.wrapperCol,label:"备注"}},[t("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator.trim",value:["remark"],expression:"[ 'remark' ]",modifiers:{trim:!0}}],attrs:{rows:2,placeholder:"请输入备注"}})],1)],1)],1)],2)],1)},r=[],n=i("88bc"),l=i.n(n),o=i("4ec3"),s=i("ca00"),d=i("ac0d"),c={name:"DepotModal",mixins:[d["b"]],data:function(){return{title:"操作",visible:!1,model:{},maskStyle:"",userList:[],isReadOnly:!1,labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:16}},confirmLoading:!1,form:this.$form.createForm(this),validatorRules:{name:{rules:[{required:!0,message:"请输入仓库名称!"},{min:2,max:30,message:"长度在 2 到 30 个字符",trigger:"blur"},{validator:this.validateDepotName}]}}}},created:function(){this.initUser()},methods:{add:function(){this.edit({})},edit:function(e){var t=this;this.form.resetFields(),this.model=Object.assign({},e),this.visible=!0,this.$nextTick((function(){t.form.setFieldsValue(l()(t.model,"name","address","warehousing","truckage","principal","sort","remark")),Object(s["a"])("depotModal")}))},close:function(){this.$emit("close"),this.visible=!1},handleOk:function(){var e=this,t=this;this.form.validateFields((function(i,a){if(!i){t.confirmLoading=!0;var r,n=Object.assign(e.model,a);r=e.model.id?Object(o["I"])(n):Object(o["b"])(n),r.then((function(e){200===e.code?t.$emit("ok"):t.$message.warning(e.data.message)})).finally((function(){t.confirmLoading=!1,t.close()}))}}))},handleCancel:function(){this.close()},validateDepotName:function(e,t,i){var a={name:t,id:this.model.id?this.model.id:0};Object(o["u"])(a).then((function(e){e&&200===e.code?e.data.status?i("名称已经存在"):i():i(e.data)}))},initUser:function(){var e=this;Object(o["wb"])({}).then((function(t){t&&(e.userList=t)}))}}},u=c,m=i("2877"),f=Object(m["a"])(u,a,r,!1,null,"56ffd629",null);t["default"]=f.exports}}]);