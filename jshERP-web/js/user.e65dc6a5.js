(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["user"],{1348:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=this,r=t._self._c;return r("div",{staticClass:"main user-layout-register"},[r("a-form",{ref:"formRegister",attrs:{autoFormCreate:function(t){e.form=t},id:"formRegister"}},[r("a-form-item",{attrs:{fieldDecoratorId:"username",fieldDecoratorOptions:{rules:[{required:!0,message:"用户名不能为空"},{validator:this.handleUserName}],validateTrigger:["change","blur"],validateFirst:!0}}},[r("a-input",{attrs:{size:"large",type:"text",autocomplete:"false",placeholder:"请输入用户名"}})],1),r("a-popover",{attrs:{placement:"rightTop",trigger:"click",visible:t.state.passwordLevelChecked}},[r("template",{slot:"content"},[r("div",{style:{width:"240px"}},[r("div",{class:["user-register",t.passwordLevelClass]},[t._v("强度："),r("span",[t._v(t._s(t.passwordLevelName))])]),r("a-progress",{attrs:{percent:t.state.percent,showInfo:!1,strokeColor:t.passwordLevelColor}}),r("div",{staticStyle:{"margin-top":"10px"}},[r("span",[t._v("请至少输入 6 个字符。请不要使用容易被猜到的密码。")])])],1)]),r("a-form-item",{attrs:{fieldDecoratorId:"password",fieldDecoratorOptions:{rules:[{required:!1},{validator:this.handlePasswordLevel}],validateTrigger:["change","blur"],validateFirst:!0}}},[r("a-input-password",{attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"至少6位密码，区分大小写"},on:{click:t.handlePasswordInputClick}})],1)],2),r("a-form-item",{attrs:{fieldDecoratorId:"password2",fieldDecoratorOptions:{rules:[{required:!0,message:"至少6位密码，区分大小写"},{validator:this.handlePasswordCheck}],validateTrigger:["change","blur"],validateFirst:!0}}},[r("a-input-password",{attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"确认密码"}})],1),r("a-row",{attrs:{gutter:0}},[r("a-col",{attrs:{span:14}},[r("a-form-item",{attrs:{fieldDecoratorId:"inputCode",fieldDecoratorOptions:{rules:[{required:!0,message:"验证码不能为空"},{validator:this.handleInputCode}],validateTrigger:["change","blur"],validateFirst:!0}}},[r("a-input",{attrs:{size:"large",type:"text","default-value":"",placeholder:"请输入验证码"}},[r("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"smile"},slot:"prefix"})],1)],1)],1),r("a-col",{staticStyle:{"text-align":"right"},attrs:{span:10}},[t.requestCodeSuccess?r("img",{staticStyle:{"margin-top":"2px"},attrs:{src:t.randCodeImage},on:{click:t.handleChangeCheckCode}}):r("img",{staticStyle:{"margin-top":"2px"},attrs:{src:s("d5ac")},on:{click:t.handleChangeCheckCode}})])],1),r("a-form-item",[r("a-button",{staticClass:"register-button",attrs:{size:"large",type:"primary",htmlType:"submit",loading:t.registerBtn,disabled:t.registerBtn},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSubmit.apply(null,arguments)}}},[t._v("注册租户\n      ")]),r("router-link",{staticClass:"login",attrs:{to:{name:"login"}}},[t._v("使用已有租户登录")])],1),"mobile"===t.device?r("div",{staticClass:"login-copyright"},[r("a-row",[r("a-col",[t._v("\n          © 2015-2030 Powered By\n          "),r("a",{staticStyle:{color:"#00458a"},attrs:{href:t.systemUrl,target:"_blank"}},[t._v("官方网站")])])],1)],1):t._e()],1)],1)},a=[],i=s("ac0d"),o=s("0fea"),n=s("6821"),l=s.n(n),d={0:"低",1:"低",2:"中",3:"强"},c={0:"error",1:"error",2:"warning",3:"success"},u={0:"#ff0000",1:"#ff0000",2:"#ff7e05",3:"#52c41a"},p={name:"Register",components:{},mixins:[i["b"]],data:function(){return{systemTitle:window.SYS_TITLE,systemUrl:window.SYS_URL,form:null,uuid:"",randCodeImage:"",requestCodeSuccess:!1,state:{time:60,smsSendBtn:!1,passwordLevel:0,passwordLevelChecked:!1,percent:10,progressColor:"#FF0000"},registerBtn:!1}},computed:{passwordLevelClass:function(){return c[this.state.passwordLevel]},passwordLevelName:function(){return d[this.state.passwordLevel]},passwordLevelColor:function(){return u[this.state.passwordLevel]}},created:function(){this.handleChangeCheckCode()},methods:{handleChangeCheckCode:function(){var e=this;this.currdatetime=(new Date).getTime(),Object(o["d"])("/user/randomImage").then((function(t){200==t.code?(e.uuid=t.data.uuid,e.randCodeImage=t.data.base64,e.requestCodeSuccess=!0):(e.$message.error(t.data),e.requestCodeSuccess=!1)})).catch((function(){e.requestCodeSuccess=!1}))},handleUserName:function(e,t,s){var r=/^(?=.*[a-z]).{4,}$/;r.test(t)||s(new Error("用户名需要由4位小写字母组成!")),s()},handlePasswordLevel:function(e,t,s){var r=0,a=/^(?=.*[a-z])(?=.*\d).{6,}$/;a.test(t)||s(new Error("密码由6位数字、小写字母组成!")),/[0-9]/.test(t)&&r++,/[a-zA-Z]/.test(t)&&r++,/[^0-9a-zA-Z_]/.test(t)&&r++,this.state.passwordLevel=r,this.state.percent=30*r,r>=2?(r>=3&&(this.state.percent=100),s()):(0===r&&(this.state.percent=10),s(new Error("强度不够!")))},handlePasswordCheck:function(e,t,s){var r=this.form.getFieldValue("password");void 0===t&&s(new Error("请输入密码!")),t&&r&&t.trim()!==r.trim()&&s(new Error("两次密码不一致!")),s()},handlePasswordInputClick:function(){this.isMobile()?this.state.passwordLevelChecked=!1:this.state.passwordLevelChecked=!0},handleInputCode:function(e,t,s){s()},handleSubmit:function(){var e=this,t=this;t.registerBtn=!0,this.form.validateFields((function(s,r){if(s)t.registerBtn=!1;else{var a={loginName:r.username,password:l()(r.password),code:r.inputCode,uuid:t.uuid};Object(o["g"])("/user/registerUser",a).then((function(s){if(200===s.code){e.$notification.success({message:"提示",description:"注册成功，请使用该租户登录！",duration:5});var r=e;setTimeout((function(){r.$router.push({name:"login",params:{loginName:a.loginName}})}),2e3)}else e.$notification["error"]({message:"提示",description:s.data.message||"注册失败",duration:2}),e.form.setFieldsValue({inputCode:""}),e.handleChangeCheckCode(),t.registerBtn=!1})).catch((function(e){t.requestFailed(e)}))}}))},requestFailed:function(e){this.$notification["error"]({message:"错误",description:((e.response||{}).data||{}).message||"请求出现错误，请稍后再试",duration:4}),this.registerBtn=!1}},watch:{"state.passwordLevel":function(e){}}},h=p,g=(s("5597"),s("4789"),s("2877")),m=Object(g["a"])(h,r,a,!1,null,"8367cf48",null);t["default"]=m.exports},"2ea0":function(e,t,s){},4789:function(e,t,s){"use strict";s("2ea0")},5597:function(e,t,s){"use strict";s("66f9")},"66f9":function(e,t,s){}}]);