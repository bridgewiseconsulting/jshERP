(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-05cd2ca0","chunk-2d21e3e9"],{"30f5":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:24}},[t("a-card",{style:e.cardStyle,attrs:{bordered:!1}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchQuery.apply(null,arguments)}}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"商品信息",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{attrs:{placeholder:"请输入条码、名称、助记码、规格、型号等信息"},model:{value:e.queryParam.materialParam,callback:function(t){e.$set(e.queryParam,"materialParam",t)},expression:"queryParam.materialParam"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"单据日期",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-range-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",placeholder:["开始时间","结束时间"]},on:{change:e.onDateChange},model:{value:e.queryParam.createTimeRange,callback:function(t){e.$set(e.queryParam,"createTimeRange",t)},expression:"queryParam.createTimeRange"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[t("a-button",{attrs:{type:"primary"},on:{click:e.searchQuery}},[e._v("查询")]),t("a-button",{directives:[{name:"print",rawName:"v-print",value:"#reportPrint",expression:"'#reportPrint'"}],staticStyle:{"margin-left":"8px"},attrs:{icon:"printer"}},[e._v("打印")]),t("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"download"},on:{click:e.exportExcel}},[e._v("导出")]),t("a",{staticStyle:{"margin-left":"8px"},on:{click:e.handleToggleSearch}},[e._v("\n                  "+e._s(e.toggleSearchStatus?"收起":"展开")+"\n                  "),t("a-icon",{attrs:{type:e.toggleSearchStatus?"up":"down"}})],1)],1)]),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",[t("span",[e._v("总数量："+e._s(e.operNumberTotalStr)+"，总金额："+e._s(e.allPriceTotalStr))])])],1)],1),e.toggleSearchStatus?[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"单据编号",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{attrs:{placeholder:"请输入单据编号"},model:{value:e.queryParam.number,callback:function(t){e.$set(e.queryParam,"number",t)},expression:"queryParam.number"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"调出仓库",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-select",{staticStyle:{width:"100%"},attrs:{optionFilterProp:"children",dropdownMatchSelectWidth:!1,showSearch:"","allow-clear":"",placeholder:"请选择仓库"},model:{value:e.queryParam.depotIdF,callback:function(t){e.$set(e.queryParam,"depotIdF",t)},expression:"queryParam.depotIdF"}},e._l(e.depotList,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.id}},[e._v("\n                      "+e._s(a.depotName)+"\n                    ")])})),1)],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"调入仓库",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-select",{staticStyle:{width:"100%"},attrs:{optionFilterProp:"children",dropdownMatchSelectWidth:!1,showSearch:"","allow-clear":"",placeholder:"请选择仓库"},model:{value:e.queryParam.depotId,callback:function(t){e.$set(e.queryParam,"depotId",t)},expression:"queryParam.depotId"}},e._l(e.depotList,(function(a,r){return t("a-select-option",{key:r,attrs:{value:a.id}},[e._v("\n                      "+e._s(a.depotName)+"\n                    ")])})),1)],1)],1),e.orgaTree.length?t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"机构",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-tree-select",{staticStyle:{width:"100%"},attrs:{"allow-clear":"",treeData:e.orgaTree,placeholder:"请选择机构"},model:{value:e.queryParam.organizationId,callback:function(t){e.$set(e.queryParam,"organizationId",t)},expression:"queryParam.organizationId"}})],1)],1):e._e(),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"商品类别",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-tree-select",{staticStyle:{width:"100%"},attrs:{dropdownStyle:{maxHeight:"200px",overflow:"auto"},"allow-clear":"",treeData:e.categoryTree,placeholder:"请选择商品类别"},model:{value:e.queryParam.categoryId,callback:function(t){e.$set(e.queryParam,"categoryId",t)},expression:"queryParam.categoryId"}})],1)],1),t("a-col",{attrs:{md:6,sm:24}},[t("a-form-item",{attrs:{label:"备注",labelCol:e.labelCol,wrapperCol:e.wrapperCol}},[t("a-input",{attrs:{placeholder:"请输入备注"},model:{value:e.queryParam.remark,callback:function(t){e.$set(e.queryParam,"remark",t)},expression:"queryParam.remark"}})],1)],1)],1)]:e._e()],2)],1),t("section",{ref:"print",attrs:{id:"reportPrint"}},[t("a-table",{ref:"table",attrs:{bordered:"",size:"middle",rowKey:"id",columns:e.columns,dataSource:e.dataSource,components:e.handleDrag(e.columns),pagination:!1,scroll:e.scroll,loading:e.loading},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"numberCustomRender",fn:function(a,r){return t("span",{},[t("a",{on:{click:function(t){return e.myHandleDetail(r)}}},[e._v(e._s(r.number))])])}}])},[t("span",{attrs:{slot:"customTitle"},slot:"customTitle"},[t("a-popover",{attrs:{trigger:"click",placement:"right"}},[t("template",{slot:"content"},[t("a-checkbox-group",{attrs:{defaultValue:e.settingDataIndex},on:{change:e.onColChange},model:{value:e.settingDataIndex,callback:function(t){e.settingDataIndex=t},expression:"settingDataIndex"}},[t("a-row",{staticStyle:{width:"600px"}},[e._l(e.defColumns,(function(a,r){return[[t("a-col",{attrs:{span:6}},["rowIndex"===a.dataIndex?t("a-checkbox",{attrs:{value:a.dataIndex,disabled:""}}):e._e(),"rowIndex"!==a.dataIndex?t("a-checkbox",{attrs:{value:a.dataIndex}},[t("j-ellipsis",{attrs:{value:a.title,length:10}})],1):e._e()],1)]]}))],2),t("a-row",{staticStyle:{"padding-top":"10px"}},[t("a-col",[e._v("\n                      恢复默认列配置："),t("a-button",{attrs:{type:"link",size:"small"},on:{click:e.handleRestDefault}},[e._v("恢复默认")])],1)],1)],1)],1),t("a-icon",{attrs:{type:"setting"}})],2)],1)]),t("a-row",{staticStyle:{"margin-top":"8px","text-align":"right"},attrs:{gutter:24}},[t("a-col",{attrs:{md:24,sm:24}},[t("a-pagination",{attrs:{size:"small","show-size-changer":"",showQuickJumper:!0,current:e.ipagination.current,"page-size":e.ipagination.pageSize,"page-size-options":e.ipagination.pageSizeOptions,total:e.ipagination.total,"show-total":function(t,a){return"共 ".concat(t-Math.ceil(t/e.ipagination.pageSize)," 条")}},on:{change:e.paginationChange,showSizeChange:e.paginationShowSizeChange},scopedSlots:e._u([{key:"buildOptionText",fn:function(a){return[t("span",[e._v(e._s(a.value-1)+"条/页")])]}}])})],1)],1)],1),t("bill-detail",{ref:"modalDetail"})],1)],1)],1)},l=[],i=a("9be9"),n=a("b65a"),o=a("ca00"),s=a("0fea"),d=a("4ec3"),c=a("d579"),u=a("c1df"),p=a.n(u),m={name:"AllocationDetail",mixins:[n["a"]],components:{BillDetail:i["default"],JEllipsis:c["default"]},data:function(){return{labelCol:{span:5},wrapperCol:{span:18,offset:1},queryParam:{organId:void 0,number:"",materialParam:"",depotId:void 0,depotIdF:void 0,organizationId:void 0,beginTime:Object(o["l"])(3),endTime:Object(o["h"])(),createTimeRange:[p()(Object(o["l"])(3)),p()(Object(o["h"])())],subType:"调拨",remark:""},ipagination:{pageSize:11,pageSizeOptions:["11","21","31","101","201","301","1001","2001","3001"]},supList:[],depotList:[],orgaTree:[],categoryTree:[],operNumberTotalStr:"0",allPriceTotalStr:"0",tabKey:"1",pageName:"allocationDetail",defDataIndex:["rowIndex","number","barCode","mname","standard","model","mUnit","operNumber","unitPrice","allPrice","dname","sname","operTime","newRemark"],defColumns:[{dataIndex:"rowIndex",width:40,align:"center",slots:{title:"customTitle"},customRender:function(e,t,a){return"合计"!==e?parseInt(a)+1:e}},{title:"单据编号",dataIndex:"number",width:100,scopedSlots:{customRender:"numberCustomRender"}},{title:"条码",dataIndex:"barCode",sorter:function(e,t){return e.barCode-t.barCode},width:80},{title:"名称",dataIndex:"mname",width:120,ellipsis:!0},{title:"规格",dataIndex:"standard",width:60,ellipsis:!0},{title:"型号",dataIndex:"model",width:60,ellipsis:!0},{title:"颜色",dataIndex:"color",width:40,ellipsis:!0},{title:"品牌",dataIndex:"brand",width:60,ellipsis:!0},{title:"制造商",dataIndex:"mfrs",width:60,ellipsis:!0},{title:"单位",dataIndex:"mUnit",width:60,ellipsis:!0},{title:"数量",dataIndex:"operNumber",sorter:function(e,t){return e.operNumber-t.operNumber},width:60},{title:"单价",dataIndex:"unitPrice",sorter:function(e,t){return e.unitPrice-t.unitPrice},width:60},{title:"金额",dataIndex:"allPrice",sorter:function(e,t){return e.allPrice-t.allPrice},width:60},{title:"调出仓库",dataIndex:"dname",width:80},{title:"调入仓库",dataIndex:"sname",width:80},{title:"调拨日期",dataIndex:"operTime",width:80},{title:"备注",dataIndex:"newRemark",width:100,ellipsis:!0}],url:{list:"/depotHead/findAllocationDetail"}}},created:function(){this.getDepotData(),this.initSupplier(),this.loadAllOrgaData(),this.loadCategoryTreeData(),this.initColumnsSetting()},methods:{moment:p.a,getQueryParams:function(){var e=Object.assign({},this.queryParam,this.isorter);return e.field=this.getQueryField(),e.currentPage=this.ipagination.current,e.pageSize=this.ipagination.pageSize-1,e},onDateChange:function(e,t){this.queryParam.beginTime=t[0],this.queryParam.endTime=t[1],t[0]&&t[1]&&(this.queryParam.createTimeRange=[p()(t[0]),p()(t[1])])},loadData:function(e){var t=this;1===e&&(this.ipagination.current=1);var a=this.getQueryParams();this.loading=!0,Object(s["d"])(this.url.list,a).then((function(e){200===e.code?(t.dataSource=e.data.rows,t.ipagination.total=e.data.total,t.operNumberTotalStr=e.data.operNumberTotal.toFixed(2),t.allPriceTotalStr=e.data.allPriceTotal.toFixed(2),t.tableAddTotalRow(t.columns,t.dataSource)):510===e.code?t.$message.warning(e.data):t.$message.warning(e.data.message),t.loading=!1}))},initSupplier:function(){var e=this;Object(d["ab"])({}).then((function(t){t&&(e.supList=t)}))},getDepotData:function(){var e=this;Object(s["d"])("/depot/findDepotByCurrentUser").then((function(t){200===t.code?e.depotList=t.data:e.$message.info(t.data)}))},loadAllOrgaData:function(){var e=this,t={};Object(d["fb"])(t).then((function(t){t&&(e.orgaTree=t)}))},loadCategoryTreeData:function(){var e=this,t={id:""};Object(d["yb"])(t).then((function(t){if(t){e.categoryTree=[];for(var a=0;a<t.length;a++){var r=t[a];e.categoryTree.push(r)}}}))},myHandleDetail:function(e){var t=this;Object(d["W"])({number:e.number}).then((function(a){a&&200===a.code&&(t.$refs.modalDetail.isCanBackCheck=!1,t.handleDetail(a.data,e.newType))}))},searchQuery:function(){""==this.queryParam.beginTime||""==this.queryParam.endTime?this.$message.warning("请选择单据日期！"):this.loadData(1)},exportExcel:function(){for(var e=[],t="单据编号,条码,名称,规格,型号,颜色,品牌,制造商,单位,数量,单价,金额,调出仓库,调入仓库,调拨日期,备注",a=0;a<this.dataSource.length;a++){var r=[],l=this.dataSource[a];r.push(l.number,l.barCode,l.mname,l.standard,l.model,l.color,l.brand,l.mfrs,l.mUnit,l.operNumber,l.unitPrice,l.allPrice,l.dname,l.sname,l.operTime,l.newRemark),e.push(r)}var i="单据日期："+this.queryParam.beginTime+"~"+this.queryParam.endTime;this.handleExportXlsPost("调拨明细","调拨明细",t,i,e)}}},h=m,g=(a("4b3c"),a("2877")),b=Object(g["a"])(h,r,l,!1,null,"50be4e77",null);t["default"]=b.exports},"4b3c":function(e,t,a){"use strict";a("c2ef")},c2ef:function(e,t,a){},d579:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e._self._c;return t("a-tooltip",{attrs:{placement:"topLeft"}},[t("template",{slot:"title"},[t("span",[e._v(e._s(e.value))])]),e._v("\n  "+e._s(e._f("ellipsis")(e.value,e.length))+"\n")],2)},l=[],i={name:"JEllipsis",props:{value:{type:String,required:!1},length:{type:Number,required:!1,default:25}}},n=i,o=a("2877"),s=Object(o["a"])(n,r,l,!1,null,"4de15389",null);t["default"]=s.exports}}]);