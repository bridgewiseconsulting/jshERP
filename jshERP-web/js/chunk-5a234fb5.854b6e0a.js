(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5a234fb5","chunk-2d21e3e9"],{"4c7c":function(t,e,a){"use strict";a("e10d")},a87d:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:24}},[e("a-card",{style:t.cardStyle,attrs:{bordered:!1}},[e("div",{staticClass:"table-page-search-wrapper"},[e("a-form",{attrs:{layout:"inline"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchQuery.apply(null,arguments)}}},[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"商品信息",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-input",{attrs:{placeholder:"请输入条码、名称、助记码、规格、型号等信息"},model:{value:t.queryParam.materialParam,callback:function(e){t.$set(t.queryParam,"materialParam",e)},expression:"queryParam.materialParam"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"单据日期",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-range-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD",placeholder:["开始时间","结束时间"]},on:{change:t.onDateChange},model:{value:t.queryParam.createTimeRange,callback:function(e){t.$set(t.queryParam,"createTimeRange",e)},expression:"queryParam.createTimeRange"}})],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("span",{staticClass:"table-page-search-submitButtons",staticStyle:{float:"left",overflow:"hidden"}},[e("a-button",{attrs:{type:"primary"},on:{click:t.searchQuery}},[t._v("查询")]),e("a-button",{directives:[{name:"print",rawName:"v-print",value:"#reportPrint",expression:"'#reportPrint'"}],staticStyle:{"margin-left":"8px"},attrs:{icon:"printer"}},[t._v("打印")]),e("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"download"},on:{click:t.exportExcel}},[t._v("导出")]),e("a",{staticStyle:{"margin-left":"8px"},on:{click:t.handleToggleSearch}},[t._v("\n                  "+t._s(t.toggleSearchStatus?"收起":"展开")+"\n                  "),e("a-icon",{attrs:{type:t.toggleSearchStatus?"up":"down"}})],1)],1)]),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",[e("span",[t._v("实际零售金额："+t._s(t.realityPriceTotal))])])],1)],1),t.toggleSearchStatus?[e("a-row",{attrs:{gutter:24}},[e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"会员卡号",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-select",{attrs:{placeholder:"请选择会员卡号",dropdownMatchSelectWidth:!1,showSearch:"","allow-clear":"",optionFilterProp:"children"},model:{value:t.queryParam.organId,callback:function(e){t.$set(t.queryParam,"organId",e)},expression:"queryParam.organId"}},t._l(t.retailList,(function(a,r){return e("a-select-option",{key:r,attrs:{value:a.id}},[t._v("\n                      "+t._s(a.supplier)+"\n                    ")])})),1)],1)],1),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"仓库",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-select",{staticStyle:{width:"100%"},attrs:{optionFilterProp:"children",dropdownMatchSelectWidth:!1,showSearch:"","allow-clear":"",placeholder:"请选择仓库"},model:{value:t.queryParam.depotId,callback:function(e){t.$set(t.queryParam,"depotId",e)},expression:"queryParam.depotId"}},t._l(t.depotList,(function(a,r){return e("a-select-option",{key:r,attrs:{value:a.id}},[t._v("\n                      "+t._s(a.depotName)+"\n                    ")])})),1)],1)],1),t.orgaTree.length?e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"机构",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-tree-select",{staticStyle:{width:"100%"},attrs:{"allow-clear":"",treeData:t.orgaTree,placeholder:"请选择机构"},model:{value:t.queryParam.organizationId,callback:function(e){t.$set(t.queryParam,"organizationId",e)},expression:"queryParam.organizationId"}})],1)],1):t._e(),e("a-col",{attrs:{md:6,sm:24}},[e("a-form-item",{attrs:{label:"商品类别",labelCol:t.labelCol,wrapperCol:t.wrapperCol}},[e("a-tree-select",{staticStyle:{width:"100%"},attrs:{dropdownStyle:{maxHeight:"200px",overflow:"auto"},"allow-clear":"",treeData:t.categoryTree,placeholder:"请选择商品类别"},model:{value:t.queryParam.categoryId,callback:function(e){t.$set(t.queryParam,"categoryId",e)},expression:"queryParam.categoryId"}})],1)],1)],1)]:t._e()],2)],1),e("section",{ref:"print",attrs:{id:"reportPrint"}},[e("a-table",{ref:"table",attrs:{bordered:"",size:"middle",rowKey:"id",columns:t.columns,dataSource:t.dataSource,components:t.handleDrag(t.columns),pagination:!1,scroll:t.scroll,loading:t.loading},on:{change:t.handleTableChange}},[e("span",{attrs:{slot:"customTitle"},slot:"customTitle"},[e("a-popover",{attrs:{trigger:"click",placement:"right"}},[e("template",{slot:"content"},[e("a-checkbox-group",{attrs:{defaultValue:t.settingDataIndex},on:{change:t.onColChange},model:{value:t.settingDataIndex,callback:function(e){t.settingDataIndex=e},expression:"settingDataIndex"}},[e("a-row",{staticStyle:{width:"600px"}},[t._l(t.defColumns,(function(a,r){return[[e("a-col",{attrs:{span:6}},["rowIndex"===a.dataIndex?e("a-checkbox",{attrs:{value:a.dataIndex,disabled:""}}):t._e(),"rowIndex"!==a.dataIndex?e("a-checkbox",{attrs:{value:a.dataIndex}},[e("j-ellipsis",{attrs:{value:a.title,length:10}})],1):t._e()],1)]]}))],2),e("a-row",{staticStyle:{"padding-top":"10px"}},[e("a-col",[t._v("\n                      恢复默认列配置："),e("a-button",{attrs:{type:"link",size:"small"},on:{click:t.handleRestDefault}},[t._v("恢复默认")])],1)],1)],1)],1),e("a-icon",{attrs:{type:"setting"}})],2)],1)]),e("a-row",{staticStyle:{"margin-top":"8px","text-align":"right"},attrs:{gutter:24}},[e("a-col",{attrs:{md:24,sm:24}},[e("a-pagination",{attrs:{size:"small","show-size-changer":"",showQuickJumper:!0,current:t.ipagination.current,"page-size":t.ipagination.pageSize,"page-size-options":t.ipagination.pageSizeOptions,total:t.ipagination.total,"show-total":function(e,a){return"共 ".concat(e-Math.ceil(e/t.ipagination.pageSize)," 条")}},on:{change:t.paginationChange,showSizeChange:t.paginationShowSizeChange},scopedSlots:t._u([{key:"buildOptionText",fn:function(a){return[e("span",[t._v(t._s(a.value-1)+"条/页")])]}}])})],1)],1)],1)])],1)],1)},i=[],l=a("b65a"),n=a("ca00"),o=a("0fea"),s=a("4ec3"),d=a("d579"),c=a("c1df"),u=a.n(c),m=a("2b0e"),p={name:"RetailOutReport",mixins:[l["a"]],components:{JEllipsis:d["default"]},data:function(){return{labelCol:{span:5},wrapperCol:{span:18,offset:1},queryParam:{materialParam:"",beginTime:Object(n["l"])(3),endTime:Object(n["h"])(),createTimeRange:[u()(Object(n["l"])(3)),u()(Object(n["h"])())],organId:void 0,depotId:void 0,organizationId:void 0,categoryId:void 0,mpList:Object(n["i"])(m["a"].ls.get("materialPropertyList"))},ipagination:{pageSize:11,pageSizeOptions:["11","21","31","101","201"]},defaultTimeStr:"",retailList:[],depotList:[],orgaTree:[],categoryTree:[],realityPriceTotal:"",tabKey:"1",pageName:"retailOutReport",defDataIndex:["rowIndex","barCode","materialName","materialStandard","materialModel","materialUnit","outSum","outSumPrice","inSum","inSumPrice","outInSumPrice"],defColumns:[{dataIndex:"rowIndex",width:60,align:"center",slots:{title:"customTitle"},customRender:function(t,e,a){return"合计"!==t?parseInt(a)+1:t}},{title:"条码",dataIndex:"barCode",sorter:function(t,e){return t.barCode-e.barCode},width:160},{title:"名称",dataIndex:"materialName",width:160,ellipsis:!0},{title:"规格",dataIndex:"materialStandard",width:80,ellipsis:!0},{title:"型号",dataIndex:"materialModel",width:80,ellipsis:!0},{title:"颜色",dataIndex:"materialColor",width:60,ellipsis:!0},{title:"品牌",dataIndex:"materialBrand",width:80,ellipsis:!0},{title:"制造商",dataIndex:"materialMfrs",width:80,ellipsis:!0},{title:"扩展1",dataIndex:"otherField1",width:80,ellipsis:!0},{title:"扩展2",dataIndex:"otherField2",width:80,ellipsis:!0},{title:"扩展3",dataIndex:"otherField3",width:80,ellipsis:!0},{title:"单位",dataIndex:"materialUnit",width:80,ellipsis:!0},{title:"零售数量",dataIndex:"outSum",sorter:function(t,e){return t.outSum-e.outSum},width:80},{title:"零售金额",dataIndex:"outSumPrice",sorter:function(t,e){return t.outSumPrice-e.outSumPrice},width:80},{title:"退货数量",dataIndex:"inSum",sorter:function(t,e){return t.inSum-e.inSum},width:80},{title:"退货金额",dataIndex:"inSumPrice",sorter:function(t,e){return t.inSumPrice-e.inSumPrice},width:80},{title:"实际零售金额",dataIndex:"outInSumPrice",sorter:function(t,e){return t.outInSumPrice-e.outInSumPrice},width:100}],url:{list:"/depotItem/retailOut"}}},created:function(){this.initRetail(),this.getDepotData(),this.loadAllOrgaData(),this.loadCategoryTreeData(),this.initColumnsSetting(),this.handleChangeOtherField(0)},methods:{moment:u.a,getQueryParams:function(){var t=Object.assign({},this.queryParam,this.isorter);return t.monthTime=this.queryParam.monthTime,t.field=this.getQueryField(),t.currentPage=this.ipagination.current,t.pageSize=this.ipagination.pageSize-1,t},onDateChange:function(t,e){this.queryParam.beginTime=e[0],this.queryParam.endTime=e[1],e[0]&&e[1]&&(this.queryParam.createTimeRange=[u()(e[0]),u()(e[1])])},loadData:function(t){var e=this;1===t&&(this.ipagination.current=1);var a=this.getQueryParams();this.loading=!0,Object(o["d"])(this.url.list,a).then((function(t){200===t.code?(e.dataSource=t.data.rows,e.ipagination.total=t.data.total,e.tableAddTotalRow(e.columns,e.dataSource),e.realityPriceTotal=t.data.realityPriceTotal):510===t.code?e.$message.warning(t.data):e.$message.warning(t.data.message),e.loading=!1}))},initRetail:function(){var t=this;Object(s["Z"])({}).then((function(e){e&&(t.retailList=e)}))},getDepotData:function(){var t=this;Object(o["d"])("/depot/findDepotByCurrentUser").then((function(e){200===e.code?t.depotList=e.data:t.$message.info(e.data)}))},loadAllOrgaData:function(){var t=this,e={};Object(s["fb"])(e).then((function(e){e&&(t.orgaTree=e)}))},loadCategoryTreeData:function(){var t=this,e={id:""};Object(s["yb"])(e).then((function(e){if(e){t.categoryTree=[];for(var a=0;a<e.length;a++){var r=e[a];t.categoryTree.push(r)}}}))},searchQuery:function(){""==this.queryParam.beginTime||""==this.queryParam.endTime?this.$message.warning("请选择单据日期！"):this.loadData(1)},exportExcel:function(){for(var t=[],e=Object(n["i"])(m["a"].ls.get("materialPropertyList")),a="条码,名称,规格,型号,颜色,品牌,制造商,"+e+",单位,零售数量,零售金额,退货数量,退货金额,实际零售金额",r=0;r<this.dataSource.length;r++){var i=[],l=this.dataSource[r];i.push(l.barCode,l.materialName,l.materialStandard,l.materialModel,l.materialColor,l.materialBrand,l.materialMfrs,l.otherField1,l.otherField2,l.otherField3,l.materialUnit,l.outSum,l.outSumPrice,l.inSum,l.inSumPrice,l.outInSumPrice),t.push(i)}var o="单据日期："+this.queryParam.beginTime+"~"+this.queryParam.endTime;this.handleExportXlsPost("零售统计","零售统计",a,o,t)}}},h=p,g=(a("4c7c"),a("2877")),f=Object(g["a"])(h,r,i,!1,null,"c063e420",null);e["default"]=f.exports},d579:function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t._self._c;return e("a-tooltip",{attrs:{placement:"topLeft"}},[e("template",{slot:"title"},[e("span",[t._v(t._s(t.value))])]),t._v("\n  "+t._s(t._f("ellipsis")(t.value,t.length))+"\n")],2)},i=[],l={name:"JEllipsis",props:{value:{type:String,required:!1},length:{type:Number,required:!1,default:25}}},n=l,o=a("2877"),s=Object(o["a"])(n,r,i,!1,null,"4de15389",null);e["default"]=s.exports},e10d:function(t,e,a){}}]);